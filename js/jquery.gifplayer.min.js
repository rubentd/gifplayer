(function(b){function a(d,c){this.previewElement=d;this.spinnerElement=b("<div class = 'spinner'></div>");this.options=c}a.prototype={activate:function(){this.wrap();this.addSpinner();this.addControl();this.addEvents()},wrap:function(){this.wrapper=this.previewElement.wrap("<div class='gifplayer-wrapper'></div>").parent();this.wrapper.css("width",this.previewElement.width());this.wrapper.css("height",this.previewElement.height());this.previewElement.addClass("gifplayer");this.previewElement.css("cursor","pointer")},getGifSrc:function(){console.log(this.previewElement.attr("data-gif"));var c;if(this.previewElement.attr("data-gif")){c=this.previewElement.attr("data-gif")}else{c=this.previewElement.attr("src").replace(".png",".gif")}return c},addControl:function(){this.playElement=b("<ins class='play-gif'>"+this.options.playText+"</ins>");this.playElement.css("left",this.previewElement.width()/2+this.playElement.width()/2);this.wrapper.append(this.playElement)},addEvents:function(){var c=this;c.playElement.click(function(d){b(this).hide();c.spinnerElement.show();c.loadGif();d.preventDefault();d.stopPropagation()});c.spinnerElement.click(function(d){b(this).hide();c.playElement.show();d.preventDefault();d.stopPropagation()});c.previewElement.click(function(d){if(c.playElement.is(":visible")){c.playElement.hide();c.spinnerElement.show();c.loadGif()}d.preventDefault();d.stopPropagation()})},loadGif:function(){var f=this.getGifSrc();var d=this.previewElement.width();var c=this.previewElement.height();var e=this;b("<img src='"+f+"' width='"+d+"' height=' "+c+" '/>").load(function(){b(this).css("cursor","pointer");b(this).css("position","absolute");b(this).css("top","0");b(this).css("left","0");e.gifElement=b(this);e.previewElement.hide();e.wrapper.append(e.gifElement);e.spinnerElement.hide();b(this).click(function(g){b(this).remove();e.previewElement.show();e.playElement.show();g.preventDefault();g.stopPropagation()})})},addSpinner:function(){this.wrapper.append(this.spinnerElement);this.spinnerElement.hide()}};b.fn.gifplayer=function(c){this.each(function(){c=b.extend({},b.fn.gifplayer.defaults,c);var d=new a(b(this),c);d.activate()})};b.fn.gifplayer.defaults={playText:"gif"}})(jQuery);